# üöÄ Integrated Tool System - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

## üìã –û–±–∑–æ—Ä

–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –¥–≤–µ –º–æ—â–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:

- **APIResolverV2** - —É–º–Ω—ã–π –≤—ã–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Å –≥—Ä–∞—Ñ–æ–≤–æ–π –ø–∞–º—è—Ç—å—é
- **UniversalToolConnector** - –Ω–∞–¥–µ–∂–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ‚Üí LLM Agent ‚Üí Integrated Tool System
                                    ‚Üì
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚Üì                                   ‚Üì
            APIResolverV2                        UniversalToolConnector
            (–ú–æ–∑–≥ –≤—ã–±–æ—Ä–∞)                        (–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å)
                    ‚Üì                                   ‚Üì
            - –ì—Ä–∞—Ñ–æ–≤–∞—è –ø–∞–º—è—Ç—å                    - –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
            - –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞               - –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤
            - –ü–æ–∏—Å–∫ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö API              - HTTP –∑–∞–ø—Ä–æ—Å—ã
            - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–±–æ—Ä–∞                 - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤
```

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
src/
‚îú‚îÄ‚îÄ integrated_tool_system.py    # –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
‚îú‚îÄ‚îÄ api_resolver_v2.py          # –°–∏—Å—Ç–µ–º–∞ –≤—ã–±–æ—Ä–∞ API
‚îú‚îÄ‚îÄ llm_agent_v2.py             # LLM Agent —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π
‚îî‚îÄ‚îÄ ...

tool_api/
‚îú‚îÄ‚îÄ connectors/
‚îÇ   ‚îî‚îÄ‚îÄ universal_connector.py   # –°–∏—Å—Ç–µ–º–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è API
‚îú‚îÄ‚îÄ tools/                       # JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ todoist.create_task.json
‚îÇ   ‚îú‚îÄ‚îÄ todoist.get_tasks.json
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ catalogs/
    ‚îî‚îÄ‚îÄ tool_api.catalog.json    # –ö–∞—Ç–∞–ª–æ–≥ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

tool_api_catalog/
‚îî‚îÄ‚îÄ api_catalog.json            # –ö–∞—Ç–∞–ª–æ–≥ API –¥–ª—è APIResolverV2
```

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—É—Ç–µ–π –≤ `integrated_tool_system.py`:

```python
tool_system = IntegratedToolSystem(
    catalog_path="./tool_api_catalog",    # –ü—É—Ç—å –∫ –∫–∞—Ç–∞–ª–æ–≥—É API
    graph_path="./graph_memory",          # –ü—É—Ç—å –∫ –≥—Ä–∞—Ñ–æ–≤–æ–π –ø–∞–º—è—Ç–∏
    log_path="./logs",                    # –ü—É—Ç—å –∫ –ª–æ–≥–∞–º
    tools_dir="./tool_api/tools"          # –ü—É—Ç—å –∫ JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º
)
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤ –≤ `.env`:

```env
# API –∫–ª—é—á–∏ –¥–ª—è –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
todoist_token=your_todoist_token_here
google_translate_key=your_google_key_here
openai_api_key=your_openai_key_here
```

## üéØ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1. –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from src.integrated_tool_system import process_intent

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–º–µ—Ä–µ–Ω–∏—è
result = await process_intent(
    intent_text="–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–∏–π",
    context={"text": "–ü—Ä–∏–≤–µ—Ç, –º–∏—Ä!", "target_language": "en"},
    user_id="user123",
    session_id="session456",
    graph_context="translation"
)

print(f"–£—Å–ø–µ—Ö: {result['success']}")
print(f"–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç: {result['tool_used']}")
print(f"–†–µ–π—Ç–∏–Ω–≥: {result['tool_rating']}")
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ LLM Agent

```python
from src.llm_agent_v2 import LLMAgentV2

# –°–æ–∑–¥–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞ —Å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏
agent = LLMAgentV2()

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
response = await agent.process_request(
    "–°–æ–∑–¥–∞–π –∑–∞–¥–∞—á—É –≤ Todoist: –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –æ—Ç—á–µ—Ç –¥–æ –∑–∞–≤—Ç—Ä–∞"
)
```

### 3. –ü—Ä—è–º–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

```python
from src.integrated_tool_system import IntegratedToolSystem

# –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
tool_system = IntegratedToolSystem()

# –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
tools = await tool_system.get_available_tools()
print(f"–î–æ—Å—Ç—É–ø–Ω–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤: {tools['total_connector']}")

# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
stats = await tool_system.get_tool_statistics()
print(f"–°—Ç–∞—Ç—É—Å: {stats['system_status']}")
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –õ–æ–≥–∏ –≤—ã–±–æ—Ä–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `./logs/` –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç:
- –í—ã–±—Ä–∞–Ω–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
- –†–µ–π—Ç–∏–Ω–≥ –≤—ã–±–æ—Ä–∞
- –ö–æ–Ω—Ç–µ–∫—Å—Ç –≥—Ä–∞—Ñ–∞
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### 2. –õ–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `./tool_api/logs/action_log.json`:
```json
{
  "timestamp": "2024-01-15T10:30:00",
  "tool_id": "tool_api.todoist.create_task",
  "input": {"content": "–¢–µ—Å—Ç–æ–≤–∞—è –∑–∞–¥–∞—á–∞"},
  "result": {"success": true, "data": {...}}
}
```

### 3. –ì—Ä–∞—Ñ–æ–≤–∞—è –ø–∞–º—è—Ç—å

–°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `./graph_memory/`:
- –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
- –†–µ–π—Ç–∏–Ω–≥–∏ —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏
- –ò—Å—Ç–æ—Ä–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

## üîç –û—Ç–ª–∞–¥–∫–∞

### 1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

```bash
python test_integration.py
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
tools = await get_available_tools()
print(f"–ö–∞—Ç–∞–ª–æ–≥: {tools['total_catalog']}")
print(f"–ö–æ–Ω–Ω–µ–∫—Ç–æ—Ä: {tools['total_connector']}")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
stats = await get_tool_statistics()
print(f"–°—Ç–∞—Ç—É—Å: {stats['system_status']}")
```

### 3. –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### –ü—Ä–æ–±–ª–µ–º–∞: "No tool found for intent"
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞—Ç–∞–ª–æ–≥ `tool_api/catalogs/tool_api.catalog.json`

#### –ü—Ä–æ–±–ª–µ–º–∞: "Secrets file not found"
**–†–µ—à–µ–Ω–∏–µ**: –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` —Å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–º–∏ API –∫–ª—é—á–∞–º–∏

#### –ü—Ä–æ–±–ª–µ–º–∞: "Module not found"
**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—É—Ç–∏ –≤ `sys.path.append()` –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

## üöÄ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞

#### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ JSON –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```json
// tool_api/tools/my_new_tool.json
{
  "id": "tool_api.my_new_tool",
  "description": "–û–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞",
  "intent": "my_intent",
  "method": "POST",
  "url": "https://api.example.com/endpoint",
  "headers": {
    "Authorization": "Bearer {{secrets.my_api_key}}"
  },
  "input_schema": {
    "param1": "string",
    "param2": "number?"
  },
  "output_schema": {
    "result": "string"
  }
}
```

#### –®–∞–≥ 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∫–∞—Ç–∞–ª–æ–≥

```json
// tool_api/catalogs/tool_api.catalog.json
{
  "tools": [
    {
      "id": "tool_api.my_new_tool",
      "intent": "my_intent",
      "service": "my_service",
      "description": "–û–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞"
    }
  ]
}
```

#### –®–∞–≥ 3: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞

```env
# .env
my_api_key=your_api_key_here
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ APIResolverV2

–î–æ–±–∞–≤—å—Ç–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ API –≤ `tool_api_catalog/api_catalog.json`:

```json
{
  "apis": [
    {
      "name": "my_new_tool",
      "source": "My Service",
      "endpoint": "/my_endpoint",
      "functions": ["my_function"],
      "keywords": ["my", "new", "tool"],
      "rating": 0.9,
      "reliability": 0.95,
      "speed": 0.8,
      "popularity": 100,
      "license": "MIT",
      "limits": {"requests_per_minute": 60}
    }
  ]
}
```

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### 1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ì—Ä–∞—Ñ–æ–≤–∞—è –ø–∞–º—è—Ç—å –∫—ç—à–∏—Ä—É–µ—Ç —É—Å–ø–µ—à–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
- **–ü–∞—Ä–∞–ª–ª–µ–ª–∏–∑–º**: –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
- **–¢–∞–π–º–∞—É—Ç—ã**: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∞–π–º–∞—É—Ç–æ–≤ –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤

### 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
stats = await get_tool_statistics()
print(f"–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ API: {stats['api_statistics']['total_apis']}")
print(f"–ö–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤ –≤ –ø–∞–º—è—Ç–∏: {len(stats['graph_statistics']['contexts'])}")
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### 1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞–º–∏

- –°–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `.env` —Ñ–∞–π–ª–µ
- –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ `{{secrets.key}}`
- –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ

### 2. –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ `input_schema`
- –¢–∏–ø–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### 3. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- –¢–∞–π–º–∞—É—Ç—ã –Ω–∞ HTTP –∑–∞–ø—Ä–æ—Å—ã
- –õ–∏–º–∏—Ç—ã –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è URL –∏ –º–µ—Ç–æ–¥–æ–≤

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:

‚úÖ **–£–º–Ω—ã–π –≤—ã–±–æ—Ä** –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–ø—ã—Ç–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞  
‚úÖ **–ù–∞–¥–µ–∂–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ** —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é  
‚úÖ **–ì—Ä–∞—Ñ–æ–≤—É—é –ø–∞–º—è—Ç—å** –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π  
‚úÖ **–ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞  
‚úÖ **–ü—Ä–æ—Å—Ç–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ** –Ω–æ–≤—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏  

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ! üöÄ 