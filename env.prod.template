# =====================================================
# ISKALA Production Environment Configuration Template
# =====================================================
# Copy this file to .env.prod and update values for your production environment

# =====================================================
# Security Configuration (CRITICAL - CHANGE THESE!)
# =====================================================

# Neo4j Database Authentication
NEO4J_PASSWORD=change_this_strong_neo4j_password_123!

# Redis Cache Authentication  
REDIS_PASSWORD=change_this_strong_redis_password_456!

# API Keys for Tool Server (comma-separated)
API_KEYS=your_production_api_key_1,your_production_api_key_2

# Grafana Admin Password (if monitoring enabled)
GRAFANA_PASSWORD=change_this_grafana_password_789!

# =====================================================
# Performance & Resource Configuration
# =====================================================

# Neo4j Memory Settings
NEO4J_HEAP_INITIAL=2g
NEO4J_HEAP_MAX=4g

# Redis Memory Limit
REDIS_MAX_MEMORY=512mb

# Application Performance
EMBEDDING_BATCH_SIZE=16
SEARCH_CACHE_TTL=3600
MAX_CONCURRENT_REQUESTS=100

# =====================================================
# Application Configuration
# =====================================================

# Environment Mode
ENVIRONMENT=production

# Logging Configuration
LOG_LEVEL=INFO
LOG_FORMAT=json

# Build Information
BUILD_VERSION=1.0.0
BUILD_DATE=$(date -u +%Y-%m-%dT%H:%M:%SZ)
BUILD_COMMIT=$(git rev-parse --short HEAD 2>/dev/null || echo "unknown")

# =====================================================
# Security Features
# =====================================================

# API Security
ENABLE_API_KEY_AUTH=true

# Rate Limiting
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=60

# CORS Settings (adjust for your domain)
ALLOWED_ORIGINS=https://yourdomain.com,https://api.yourdomain.com

# =====================================================
# Monitoring & Observability
# =====================================================

# Metrics Collection
ENABLE_METRICS=true
METRICS_PORT=9090

# Health Check Intervals (seconds)
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_RETRIES=3

# =====================================================
# Database Configuration
# =====================================================

# Neo4j Database Settings
NEO4J_DATABASE=iskala-mova
NEO4J_URI=bolt://neo4j:7687
NEO4J_USERNAME=neo4j

# Redis Configuration
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0
REDIS_SSL=false

# =====================================================
# Service URLs (Internal Docker Network)
# =====================================================

# Graph Search Service
GRAPH_SEARCH_URL=http://graph_search:8004

# Tool Server URL
TOOL_SERVER_URL=http://tool_server:8003

# ISKALA Core URL (if applicable)
ISKALA_CORE_URL=http://iskala-core:8001

# =====================================================
# External Integration URLs
# =====================================================

# OpenRouter API (if used)
OPENROUTER_API_KEY=your_openrouter_api_key_here
OPENROUTER_MODEL=anthropic/claude-3-sonnet

# Other external services
EXTERNAL_API_ENDPOINT=https://api.external-service.com
EXTERNAL_API_KEY=your_external_api_key

# =====================================================
# SSL/TLS Configuration (for NGINX)
# =====================================================

# SSL Certificate paths (if using HTTPS)
SSL_CERT_PATH=/etc/nginx/ssl/cert.pem
SSL_KEY_PATH=/etc/nginx/ssl/key.pem

# SSL Configuration
SSL_PROTOCOLS=TLSv1.2 TLSv1.3
SSL_CIPHERS=ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384

# =====================================================
# Backup & Data Persistence
# =====================================================

# Data directory paths (host machine)
DATA_ROOT=/opt/iskala/data
NEO4J_DATA_PATH=/opt/iskala/data/neo4j/data
NEO4J_LOGS_PATH=/opt/iskala/data/neo4j/logs
REDIS_DATA_PATH=/opt/iskala/data/redis

# Backup configuration
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30

# =====================================================
# Development/Testing Overrides
# =====================================================

# Set to "development" for local testing with production compose
# ENVIRONMENT=development
# LOG_LEVEL=DEBUG
# ENABLE_API_KEY_AUTH=false
# ALLOWED_ORIGINS=*

# =====================================================
# Docker Compose Configuration
# =====================================================

# Compose project name
COMPOSE_PROJECT_NAME=iskala-prod

# Docker image tags (for CI/CD)
GRAPH_SEARCH_IMAGE_TAG=latest
TOOL_SERVER_IMAGE_TAG=latest

# Resource limits (for Docker Swarm mode)
DEPLOY_REPLICAS_GRAPH_SEARCH=2
DEPLOY_REPLICAS_TOOL_SERVER=1

# =====================================================
# INSTRUCTIONS FOR PRODUCTION DEPLOYMENT
# =====================================================

# 1. Copy this file: cp env.prod.template .env.prod
# 2. Generate strong passwords for all services
# 3. Update API keys and external service URLs
# 4. Set appropriate resource limits for your hardware
# 5. Configure SSL certificates if using HTTPS
# 6. Review security settings and adjust for your environment
# 7. Test with: docker-compose -f docker-compose.prod.yml --env-file .env.prod config
# 8. Deploy with: docker-compose -f docker-compose.prod.yml --env-file .env.prod up -d

# =====================================================
# SECURITY CHECKLIST
# =====================================================

# [ ] Changed all default passwords
# [ ] Generated strong API keys  
# [ ] Configured SSL certificates
# [ ] Set up firewall rules
# [ ] Enabled API authentication
# [ ] Configured rate limiting
# [ ] Set up monitoring and alerting
# [ ] Configured backup strategy
# [ ] Reviewed CORS settings
# [ ] Set appropriate resource limits 